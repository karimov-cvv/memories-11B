<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Archive 11B | Secret Access</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { margin: 0; background: #000; color: white; font-family: -apple-system, sans-serif; overflow: hidden; }
        .tiktok-container { height: 100vh; overflow-y: scroll; scroll-snap-type: y mandatory; }
        .section { height: 100vh; scroll-snap-align: start; position: relative; display: flex; align-items: center; justify-content: center; }
        video, img { width: 100%; height: 100%; object-fit: contain; }
        .ui-overlay { position: absolute; bottom: 60px; left: 0; width: 100%; padding: 0 20px; z-index: 5; box-sizing: border-box; }
        .input-row { display: flex; gap: 10px; background: rgba(255,255,255,0.1); padding: 8px 15px; border-radius: 25px; border: 0.5px solid rgba(255,255,255,0.2); }
        .inp-text { background: transparent; border: none; color: white; flex-grow: 1; outline: none; }
    </style>
</head>
<body>
<div class="tiktok-container" id="main-container"></div>
<script>
    const firebaseConfig = { apiKey: "AIzaSyC6VJneixoX29fkyAkB8Xn784fC-f6X36U", authDomain: "archive-11b.firebaseapp.com", databaseURL: "https://archive-11b-default-rtdb.firebaseio.com", projectId: "archive-11b", storageBucket: "archive-11b.firebasestorage.app", messagingSenderId: "133107956700", appId: "1:133107956700:web:7f4d682490df09b5784f1a" };
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const currentUser = "Secret_Guest";
    let globalMuted = true;

    function initSite() {
        const contentList = [
            {id:"2",t:"video"},{id:"7",t:"video"},{id:"8",t:"video"},{id:"10",t:"video"},
            {id:"11",t:"video"},{id:"12",t:"video"},{id:"13",t:"video"},{id:"14",t:"video"},
            {id:"15",t:"video"},{id:"17",t:"video"},{id:"18",t:"video"},{id:"19",t:"video"},
            {id:"20",t:"video"},{id:"21",t:"video"},{id:"22",t:"video"},{id:"23",t:"video"},
            {id:"24",t:"video"},{id:"25",t:"video"},
            {id:"1",t:"image"},{id:"2",t:"image"},{id:"3",t:"image"},{id:"4",t:"image"},
            {id:"5",t:"image"},{id:"6",t:"image"},{id:"7",t:"image"},{id:"8",t:"image"},
            {id:"9",t:"image"},{id:"10",t:"image"},{id:"11",t:"image"},{id:"12",t:"image"}
        ];
        const container = document.getElementById('main-container');
        contentList.forEach(item => {
            const section = document.createElement('div'); section.className = 'section';
            section.innerHTML = `<div class="media-wrapper">${item.t==='video'?`<video loop playsinline muted data-src="vid${item.id}.mp4"></video>`:`<img data-src="img${item.id}.jpg">`}</div>
                <div class="ui-overlay"><div style="font-weight:bold;margin-bottom:10px;">@Secret_Guest</div><div id="list-${item.t}${item.id}" style="max-height:60px;overflow:auto;font-size:12px;margin-bottom:10px;"></div><div class="input-row"><input type="text" id="text-${item.t}${item.id}" class="inp-text" placeholder="Анонимный коммент..."><button style="color:#0095f6;border:none;background:none;font-weight:700;" onclick="sendComment('${item.t}${item.id}')">Post</button></div></div>`;
            container.appendChild(section);
            loadComments(item.t+item.id);
        });
        const obs = new IntersectionObserver((entries) => { entries.forEach(e => { const v = e.target.querySelector('video'), m = e.target.querySelector('video, img'); if (e.isIntersecting) { if (m.dataset.src) { m.src = m.dataset.src; delete m.dataset.src; } if (v) { v.muted = globalMuted; v.play().catch(()=>{}); } } else if (v) { v.pause(); } }); }, { threshold: 0.6 });
        document.querySelectorAll('.section').forEach(s => obs.observe(s));
    }
    function sendComment(id) { const t = document.getElementById('text-'+id); if(t.value.trim()) { database.ref('comments/'+id).push({name: currentUser, text: t.value.trim()}); t.value = ""; } }
    function loadComments(id) { database.ref('comments/'+id).on('value', s => { const l = document.getElementById('list-'+id); l.innerHTML = ""; if(s.val()) Object.values(s.val()).forEach(c => { l.innerHTML += `<div><b>${c.name}</b> ${c.text}</div>`; }); }); }
    initSite();
</script>
</body>
</html>
